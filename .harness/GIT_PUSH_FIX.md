# ğŸ”§ Git Push å¤±æ•—å•é¡Œä¿®æ­£æŒ‡å—

## âŒ å•é¡Œæè¿°

```
fatal: could not read Username for 'https://github.com': No such device or address
```

## ğŸ” åŸå› åˆ†æ

é€™å€‹éŒ¯èª¤è¡¨ç¤ºGitç„¡æ³•è®€å–GitHubèªè­‰è³‡è¨Šã€‚åœ¨Harness Pipelineä¸­ä½¿ç”¨HTTPS pushæ™‚ï¼Œéœ€è¦é…ç½®èªè­‰ã€‚

## âœ… è§£æ±ºæ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: åœ¨Harnessä¸­é…ç½®Personal Access Token â­ **æ¨è–¦**

#### æ­¥é©Ÿ 1: åœ¨GitHubç”ŸæˆPersonal Access Token

1. ç™»å…¥GitHub
2. å‰å¾€ **Settings** > **Developer settings** > **Personal access tokens** > **Tokens (classic)**
3. é»æ“Š **Generate new token (classic)**
4. è¨­ç½®:
   - **Note**: `Harness Pipeline - Exchange-Plan`
   - **Expiration**: 90 days æˆ– No expiration
   - **Scopes**: å‹¾é¸ `repo` (å®Œæ•´æ¬Šé™)
5. ç”Ÿæˆä¸¦**è¤‡è£½token**ï¼ˆåªæœƒé¡¯ç¤ºä¸€æ¬¡ï¼ï¼‰

#### æ­¥é©Ÿ 2: åœ¨Harnessä¸­ä¿å­˜Token

1. å‰å¾€Harness
2. **Project Settings** > **Secrets**
3. å‰µå»ºæ–°Secret:
   - Name: `github_pat`
   - Type: `Text`
   - Value: [è²¼ä¸Šæ‚¨çš„GitHub PAT]
4. ä¿å­˜

#### æ­¥é©Ÿ 3: æ›´æ–°Pipelineé…ç½®

æ›´æ–°`.harness/exchange_pipeline_verified.yml`ä¸­çš„git pushå‘½ä»¤ï¼š

```yaml
- step:
    type: "Run"
    name: "Commit and Push Results to GitHub"
    identifier: "commit_push"
    spec:
      shell: "Bash"
      command: |
        # Configure git with token
        git config user.email "harness-pipeline@dennisleehappy.org"
        git config user.name "Harness Pipeline Bot"
        
        # Set up authentication using token
        git remote set-url origin https://<+secrets.getValue("github_pat")>@github.com/National-Cheng-Chi-University-DCT-Dep/Exchange-Plan.git
        
        # Add and commit files
        if [ -d "final_applications" ] && [ "$(ls -A final_applications 2>/dev/null)" ]; then
          git add final_applications/
          
          if ! git diff --staged --quiet; then
            TIMESTAMP=$(date '+%Y%m%d_%H%M%S')
            git commit -m "feat: Generate exchange application documents - $TIMESTAMP"
            
            # Push with authentication
            git push origin HEAD:main
            
            echo "âœ… Successfully pushed to GitHub!"
          fi
        fi
```

### æ–¹æ¡ˆ 2: ä½¿ç”¨SSH Key

#### æ­¥é©Ÿ 1: ç”ŸæˆSSH Key

```bash
ssh-keygen -t ed25519 -C "harness-pipeline@dennisleehappy.org"
```

#### æ­¥é©Ÿ 2: æ·»åŠ SSH Keyåˆ°GitHub

1. è¤‡è£½å…¬é‘°å…§å®¹
2. å‰å¾€GitHub Settings > SSH and GPG keys
3. æ·»åŠ æ–°SSH key

#### æ­¥é©Ÿ 3: åœ¨Harnessä¸­ä¿å­˜ç§é‘°

1. å‰µå»ºSSH Keyé¡å‹çš„Secret
2. åç¨±: `github_ssh_key`
3. è²¼ä¸Šç§é‘°

#### æ­¥é©Ÿ 4: æ›´æ–°GitHub Connector

1. ç·¨è¼¯`gitconnector`
2. å°‡URLæ”¹ç‚ºSSHæ ¼å¼:
   ```
   git@github.com:National-Cheng-Chi-University-DCT-Dep/Exchange-Plan.git
   ```
3. é¸æ“‡SSH Keyèªè­‰
4. ä½¿ç”¨`github_ssh_key` secret

### æ–¹æ¡ˆ 3: æš«æ™‚è·³éPushï¼ˆç”¨æ–¼æ¸¬è©¦ï¼‰

å¦‚æœåªæ˜¯æƒ³æ¸¬è©¦PipelineåŠŸèƒ½ï¼Œå¯ä»¥æš«æ™‚è¨»è§£æ‰pushå‘½ä»¤ï¼š

```yaml
# Push to GitHub
# git push origin HEAD:main  # â† æš«æ™‚è¨»è§£
echo "âš ï¸ Git push skipped (for testing)"
```

é€™æ¨£æ–‡ä»¶æœƒcommitåˆ°æœ¬åœ°ï¼Œä½†ä¸æœƒpushã€‚æ‚¨å¯ä»¥åœ¨Harness UIä¸­ä¸‹è¼‰artifactsã€‚

## ğŸ¯ æ¨è–¦çš„å®Œæ•´ä¿®æ­£æ–¹æ¡ˆ

### ä½¿ç”¨Personal Access Tokenï¼ˆæœ€ç°¡å–®ï¼‰

æ›´æ–°`exchange_pipeline_verified.yml`çš„commitæ­¥é©Ÿï¼š

```yaml
- step:
    type: "Run"
    name: "Commit and Push Results to GitHub"
    identifier: "commit_push"
    spec:
      shell: "Bash"
      envVariables:
        GITHUB_TOKEN: <+secrets.getValue("github_pat")>
      command: |
        echo "Committing generated files to GitHub..."
        
        # Configure git
        git config user.email "harness-pipeline@dennisleehappy.org"
        git config user.name "Harness Pipeline Bot"
        
        # Use token for authentication
        git remote set-url origin https://${GITHUB_TOKEN}@github.com/National-Cheng-Chi-University-DCT-Dep/Exchange-Plan.git
        
        # Add and commit
        if [ -d "final_applications" ] && [ "$(ls -A final_applications 2>/dev/null)" ]; then
          git add final_applications/
          
          if ! git diff --staged --quiet; then
            TIMESTAMP=$(date '+%Y%m%d_%H%M%S')
            git commit -m "feat: Generate exchange application documents - $TIMESTAMP

Generated by Harness Pipeline
Pipeline ID: <+pipeline.sequenceId>
Execution Time: <+pipeline.startTs>"
            
            # Push with token auth
            git push origin HEAD:main
            
            echo "âœ… Successfully pushed documents to GitHub!"
            echo "Commit: $(git rev-parse --short HEAD)"
          else
            echo "â„¹ï¸ No changes to commit"
          fi
        else
          echo "âš ï¸ No documents to commit"
        fi
```

## ğŸ“‹ é©—è­‰æ­¥é©Ÿ

1. **å‰µå»ºGitHub PAT** âœ…
2. **åœ¨Harnessä¸­ä¿å­˜ç‚ºSecret** âœ…
3. **æ›´æ–°Pipelineé…ç½®** âœ…
4. **æ¸¬è©¦åŸ·è¡ŒPipeline** ğŸ”„
5. **ç¢ºèªæ–‡ä»¶æˆåŠŸpushåˆ°GitHub** âœ…

## ğŸ†˜ å¦‚æœä»ç„¶å¤±æ•—

### æª¢æŸ¥äº‹é …

1. **Tokenæ¬Šé™**: ç¢ºèªPATæœ‰`repo`æ¬Šé™
2. **Tokenæœ‰æ•ˆæœŸ**: ç¢ºèªtokenæœªéæœŸ
3. **Secretåç¨±**: ç¢ºèªPipelineä¸­çš„secretåç¨±èˆ‡Harnessä¸­ä¸€è‡´
4. **Repository URL**: ç¢ºèªURLæ ¼å¼æ­£ç¢º

### èª¿è©¦å‘½ä»¤

åœ¨Pipelineä¸­æ·»åŠ èª¿è©¦è¼¸å‡ºï¼š

```bash
# Test git authentication
git ls-remote origin &> /dev/null && echo "âœ… Git authentication successful" || echo "âŒ Git authentication failed"
```

---

**ä½¿ç”¨Personal Access Tokenæ˜¯æœ€ç°¡å–®å¯é çš„è§£æ±ºæ–¹æ¡ˆï¼** ğŸš€

